{"version":3,"file":"ln.js","sources":["../../../wizards/ln.ts"],"sourcesContent":["import { html, TemplateResult } from 'lit';\n\nimport { EditV2 } from '@openscd/oscd-api';\n\nimport { getReference, lnInstGenerator } from '@openscd/scl-lib';\n\nimport {\n  SelectionList,\n  SelectItem,\n} from '@openenergytools/filterable-lists/dist/SelectionList.js';\nimport { SclTextField } from '@openenergytools/scl-text-field';\n\nimport {\n  createElement,\n  getValue,\n  Wizard,\n  WizardActor,\n  WizardInputElement,\n} from '../foundation.js';\nimport { patterns, maxLength } from './patterns.js';\n\ntype LNodeTypeInfo = {\n  id: string;\n  lnClass: string;\n  desc: string | null;\n  element: Element;\n};\n\nfunction listLNodeTypes(doc: XMLDocument): LNodeTypeInfo[] {\n  return Array.from(\n    doc.querySelectorAll(':root > DataTypeTemplates > LNodeType'),\n  )\n    .map(type => ({\n      id: type.getAttribute('id'),\n      lnClass: type.getAttribute('lnClass'),\n      desc: type.getAttribute('desc'),\n      element: type,\n    }))\n    .filter(\n      type => type.id && type.lnClass && type.lnClass !== 'LLN0',\n    ) as LNodeTypeInfo[];\n}\n\nfunction renderCreate(lNodeTypes: LNodeTypeInfo[]): TemplateResult[] {\n  const items: SelectItem[] = lNodeTypes.map(type => ({\n    headline: type.lnClass,\n    supportingText: `#${type.id}${type.desc ? ` â€” ${type.desc}` : ''}`,\n    selected: false,\n    disabled: false,\n    attachedElement: type.element,\n  }));\n\n  /*\n   * This is a temporary workaround to enforce single selection in the\n   * SelectionList component, which currently does not support it natively.\n   */\n  const enforceSingleSelection = (event: Event): void => {\n    const list = (event.currentTarget as SelectionList)!;\n\n    const listItem = event\n      .composedPath()\n      .find(target => (target as HTMLElement).tagName === 'MD-LIST-ITEM') as\n      | HTMLElement\n      | undefined;\n    if (!listItem) {\n      return;\n    }\n\n    const itemsInDom = list.shadowRoot?.querySelectorAll('md-list-item');\n    if (!itemsInDom) {\n      return;\n    }\n\n    const index = Array.from(itemsInDom).indexOf(listItem);\n    if (index < 0) {\n      return;\n    }\n\n    setTimeout(() => {\n      const isSelected = list.items[index]?.selected ?? false;\n      list.items.forEach((item, i) => {\n        item.selected = i === index ? isSelected : false;\n      });\n      list.items = [...list.items];\n    }, 0);\n  };\n\n  return [\n    html`<selection-list\n      id=\"lnList\"\n      .items=${items}\n      filterable\n      style=\"max-height: 320px; overflow: auto;\"\n      @input=${enforceSingleSelection}\n    ></selection-list>`,\n    html`<scl-text-field\n      label=\"desc\"\n      .value=${null}\n      nullable\n      supportingText=\"Logical node description\"\n      pattern=\"${patterns.normalizedString}\"\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"prefix\"\n      .value=${null}\n      nullable\n      supportingText=\"Optional LN prefix\"\n      pattern=\"${patterns.prefix}\"\n      maxLength=\"${maxLength.prefix}\"\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"amount\"\n      .value=${'1'}\n      required\n      supportingText=\"Number of LNs to add\"\n      validationMessage=\"Number must be 1 or greater\"\n      type=\"number\"\n      min=\"1\"\n    ></scl-text-field>`,\n  ];\n}\n\nfunction createAction(parent: Element): WizardActor {\n  return (inputs: WizardInputElement[], wizard: Element): EditV2[] => {\n    const list = wizard.querySelector('#lnList') as SelectionList | null;\n    const selected = list?.selectedElements?.[0] as Element | undefined;\n    if (!selected) {\n      return [];\n    }\n\n    const lnClass = selected.getAttribute('lnClass');\n    const lnType = selected.getAttribute('id');\n    if (!lnClass || !lnType) {\n      return [];\n    }\n\n    const desc = getValue(inputs.find(i => i.label === 'desc')!);\n    const prefixValue = getValue(inputs.find(i => i.label === 'prefix')!);\n    const prefix = prefixValue?.trim() ? prefixValue.trim() : null;\n\n    const amountValue = Number(\n      getValue(inputs.find(i => i.label === 'amount')!) ?? '1',\n    );\n    const amount =\n      Number.isFinite(amountValue) && amountValue > 0\n        ? Math.floor(amountValue)\n        : 1;\n\n    const getInst = lnInstGenerator(parent, 'LN');\n    const reference = getReference(parent, 'LN');\n    const edits: EditV2[] = [];\n\n    for (let i = 0; i < amount; i += 1) {\n      const inst = getInst(lnClass);\n      if (!inst) {\n        break;\n      }\n\n      const node = createElement(parent.ownerDocument, 'LN', {\n        lnClass,\n        lnType,\n        inst,\n        desc,\n        ...(prefix ? { prefix } : {}),\n      });\n\n      edits.push({ parent, node, reference });\n    }\n\n    return edits;\n  };\n}\n\nexport function createLNWizard(parent: Element): Wizard {\n  const lNodeTypes = listLNodeTypes(parent.ownerDocument);\n\n  return {\n    title: 'Add LN',\n    primary: {\n      icon: 'save',\n      label: 'save',\n      action: createAction(parent),\n    },\n    content: renderCreate(lNodeTypes),\n  };\n}\n\nfunction reservedInstLN(\n  currentElement: Element,\n  prefixOverride?: string,\n): string[] {\n  const ldevice = currentElement.closest('LDevice');\n  if (!ldevice) {\n    return [];\n  }\n\n  const currentLnClass = currentElement.getAttribute('lnClass');\n  const targetPrefix =\n    prefixOverride !== undefined\n      ? prefixOverride\n      : currentElement.getAttribute('prefix') || '';\n\n  const lnElements = Array.from(ldevice.querySelectorAll(':scope > LN')).filter(\n    ln =>\n      ln !== currentElement &&\n      (ln.getAttribute('prefix') || '') === targetPrefix &&\n      ln.getAttribute('lnClass') === currentLnClass,\n  );\n\n  return lnElements\n    .map(ln => ln.getAttribute('inst'))\n    .filter(inst => inst !== null) as string[];\n}\n\nfunction updateAction(element: Element): WizardActor {\n  return (inputs: WizardInputElement[], _wizard: Element): EditV2[] => {\n    const attributes: Record<string, string | null> = {};\n    const keys = ['lnType', 'desc', 'prefix', 'lnClass', 'inst'];\n    keys.forEach(key => {\n      attributes[key] = getValue(inputs.find(i => i.label === key)!);\n    });\n\n    const hasChanges = keys.some(\n      key => attributes[key] !== element.getAttribute(key),\n    );\n    if (!hasChanges) {\n      return [];\n    }\n\n    const newPrefix = attributes.prefix || '';\n    const newLnClass = attributes.lnClass;\n    const newInst = attributes.inst;\n    const ldevice = element.closest('LDevice');\n    if (ldevice) {\n      const isDuplicate = Array.from(\n        ldevice.querySelectorAll(':scope > LN'),\n      ).some(\n        ln =>\n          ln !== element &&\n          (ln.getAttribute('prefix') || '') === newPrefix &&\n          ln.getAttribute('lnClass') === newLnClass &&\n          ln.getAttribute('inst') === newInst,\n      );\n      if (isDuplicate) {\n        //TODO consider reporting this to the user (e.g. notifications)\n        return [];\n      }\n    }\n\n    return [\n      {\n        element,\n        attributes,\n      },\n    ];\n  };\n}\n\nfunction renderUpdate(element: Element): TemplateResult[] {\n  const lnType = element.getAttribute('lnType');\n  const desc = element.getAttribute('desc');\n  const prefix = element.getAttribute('prefix');\n  const lnClass = element.getAttribute('lnClass');\n  const inst = element.getAttribute('inst');\n  const reserved = reservedInstLN(element);\n\n  return [\n    html`<scl-text-field\n      label=\"lnType\"\n      .value=${lnType}\n      readOnly\n      disabled\n      required\n      supportingText=\"Logical node type\"\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"desc\"\n      .value=${desc}\n      nullable\n      supportingText=\"Logical node description\"\n      pattern=\"${patterns.normalizedString}\"\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"prefix\"\n      .value=${prefix}\n      nullable\n      supportingText=\"Optional LN prefix\"\n      pattern=\"${patterns.prefix}\"\n      maxLength=\"${maxLength.prefix}\"\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"lnClass\"\n      .value=${lnClass}\n      readOnly\n      disabled\n      required\n      supportingText=\"Logical node class\"\n      pattern=\"${patterns.lnClass}\"\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"inst\"\n      .value=${inst}\n      required\n      supportingText=\"Logical node instance\"\n      pattern=\"${patterns.lnInst}\"\n      .reservedValues=${reserved}\n      @input=${(e: Event) => {\n        const field = e.target as SclTextField;\n        const currentValue = field.value ?? '';\n        const customValidityMsg = reserved.includes(currentValue)\n          ? `\"${currentValue}\" is already in use`\n          : '';\n        field.setCustomValidity(customValidityMsg);\n        field.reportValidity();\n      }}\n    ></scl-text-field>`,\n  ];\n}\n\nexport function updateLNWizard(element: Element): Wizard {\n  return {\n    title: 'Edit LN',\n    primary: {\n      icon: 'edit',\n      label: 'save',\n      action: updateAction(element),\n    },\n    content: renderUpdate(element),\n  };\n}\n"],"names":["html"],"mappings":"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"}