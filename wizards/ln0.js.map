{"version":3,"file":"ln0.js","sources":["../../../wizards/ln0.ts"],"sourcesContent":["import { html, TemplateResult } from 'lit';\n\nimport { EditV2 } from '@openscd/oscd-api';\n\nimport {\n  getValue,\n  Wizard,\n  WizardActor,\n  WizardInputElement,\n} from '../foundation.js';\nimport { patterns } from './patterns.js';\n\nfunction getLNodeTypeOptions(element: Element): string[] {\n  const doc = element.ownerDocument;\n  const lNodeTypes = Array.from(\n    doc.querySelectorAll('DataTypeTemplates > LNodeType[lnClass=\"LLN0\"]'),\n  );\n  return lNodeTypes\n    .map(type => type.getAttribute('id'))\n    .filter((id): id is string => !!id);\n}\n\nfunction render(element: Element, lnodeTypeIds: string[]): TemplateResult[] {\n  const lnType = element.getAttribute('lnType');\n  const desc = element.getAttribute('desc');\n  const lnClass = element.getAttribute('lnClass');\n  const inst = element.getAttribute('inst');\n\n  return [\n    html`<scl-select\n      label=\"lnType\"\n      .value=${lnType}\n      required\n      .selectOptions=${lnodeTypeIds}\n    ></scl-select>`,\n    html`<scl-text-field\n      label=\"desc\"\n      .value=${desc}\n      nullable\n      supportingText=\"Logical node zero description\"\n      pattern=\"${patterns.normalizedString}\"\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"lnClass\"\n      .value=${lnClass}\n      readOnly\n      disabled\n      required\n      supportingText=\"Logical node class\"\n      pattern=\"${patterns.lnClass}\"\n    ></scl-text-field>`,\n    html`<scl-text-field\n      label=\"inst\"\n      .value=${inst}\n      readOnly\n      disabled\n      supportingText=\"Logical node instance\"\n    ></scl-text-field>`,\n  ];\n}\n\nfunction updateAction(element: Element): WizardActor {\n  return (inputs: WizardInputElement[]): EditV2[] => {\n    const attributes: Record<string, string | null> = {};\n    // Key attributes omitted from update are: 'lnClass', 'inst'.\n    const keys = ['lnType', 'desc'];\n    keys.forEach(key => {\n      attributes[key] = getValue(inputs.find(i => i.label === key)!);\n    });\n\n    const hasChanges = keys.some(\n      key => attributes[key] !== element.getAttribute(key),\n    );\n    if (!hasChanges) {\n      return [];\n    }\n\n    return [\n      {\n        element,\n        attributes,\n      },\n    ];\n  };\n}\n\nexport function updateLN0Wizard(element: Element): Wizard {\n  const lnodeTypeIds = getLNodeTypeOptions(element);\n\n  return {\n    title: 'Edit LN0',\n    primary: {\n      icon: 'edit',\n      label: 'save',\n      action: updateAction(element),\n    },\n    content: render(element, lnodeTypeIds),\n  };\n}\n"],"names":["html"],"mappings":";;;;;;AAYA,SAAS,mBAAmB,CAAC,OAAgB,EAAA;AAC3C,IAAA,MAAM,GAAG,GAAG,OAAO,CAAC,aAAa;AACjC,IAAA,MAAM,UAAU,GAAG,KAAK,CAAC,IAAI,CAC3B,GAAG,CAAC,gBAAgB,CAAC,+CAA+C,CAAC,CACtE;AACD,IAAA,OAAO;SACJ,GAAG,CAAC,IAAI,IAAI,IAAI,CAAC,YAAY,CAAC,IAAI,CAAC;SACnC,MAAM,CAAC,CAAC,EAAE,KAAmB,CAAC,CAAC,EAAE,CAAC;AACvC;AAEA,SAAS,MAAM,CAAC,OAAgB,EAAE,YAAsB,EAAA;IACtD,MAAM,MAAM,GAAG,OAAO,CAAC,YAAY,CAAC,QAAQ,CAAC;IAC7C,MAAM,IAAI,GAAG,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC;IACzC,MAAM,OAAO,GAAG,OAAO,CAAC,YAAY,CAAC,SAAS,CAAC;IAC/C,MAAM,IAAI,GAAG,OAAO,CAAC,YAAY,CAAC,MAAM,CAAC;IAEzC,OAAO;AACL,QAAAA,CAAI,CAAA,CAAA;;eAEO,MAAM;;uBAEE,YAAY;AAChB,kBAAA,CAAA;AACf,QAAAA,CAAI,CAAA,CAAA;;eAEO,IAAI;;;AAGF,eAAA,EAAA,QAAQ,CAAC,gBAAgB,CAAA;AACnB,sBAAA,CAAA;AACnB,QAAAA,CAAI,CAAA,CAAA;;eAEO,OAAO;;;;;AAKL,eAAA,EAAA,QAAQ,CAAC,OAAO,CAAA;AACV,sBAAA,CAAA;AACnB,QAAAA,CAAI,CAAA,CAAA;;eAEO,IAAI;;;;AAII,sBAAA,CAAA;KACpB;AACH;AAEA,SAAS,YAAY,CAAC,OAAgB,EAAA;IACpC,OAAO,CAAC,MAA4B,KAAc;QAChD,MAAM,UAAU,GAAkC,EAAE;;AAEpD,QAAA,MAAM,IAAI,GAAG,CAAC,QAAQ,EAAE,MAAM,CAAC;AAC/B,QAAA,IAAI,CAAC,OAAO,CAAC,GAAG,IAAG;YACjB,UAAU,CAAC,GAAG,CAAC,GAAG,QAAQ,CAAC,MAAM,CAAC,IAAI,CAAC,CAAC,IAAI,CAAC,CAAC,KAAK,KAAK,GAAG,CAAE,CAAC;AAChE,QAAA,CAAC,CAAC;QAEF,MAAM,UAAU,GAAG,IAAI,CAAC,IAAI,CAC1B,GAAG,IAAI,UAAU,CAAC,GAAG,CAAC,KAAK,OAAO,CAAC,YAAY,CAAC,GAAG,CAAC,CACrD;QACD,IAAI,CAAC,UAAU,EAAE;AACf,YAAA,OAAO,EAAE;QACX;QAEA,OAAO;AACL,YAAA;gBACE,OAAO;gBACP,UAAU;AACX,aAAA;SACF;AACH,IAAA,CAAC;AACH;AAEM,SAAU,eAAe,CAAC,OAAgB,EAAA;AAC9C,IAAA,MAAM,YAAY,GAAG,mBAAmB,CAAC,OAAO,CAAC;IAEjD,OAAO;AACL,QAAA,KAAK,EAAE,UAAU;AACjB,QAAA,OAAO,EAAE;AACP,YAAA,IAAI,EAAE,MAAM;AACZ,YAAA,KAAK,EAAE,MAAM;AACb,YAAA,MAAM,EAAE,YAAY,CAAC,OAAO,CAAC;AAC9B,SAAA;AACD,QAAA,OAAO,EAAE,MAAM,CAAC,OAAO,EAAE,YAAY,CAAC;KACvC;AACH;;;;"}